read.table("~/projects/aliceSimsMasters/SSOtter.NoBott.txt")->noBott
read.table("~/projects/alice/aliceSimsMasters/SSOtter.NoBott.txt")->noBott
read.table("~/projects/alice/aliceSimsMasters/SSOtter.Bott.txt")->Bott
read.table("~/projects/alice/aliceSimsMasters/SSOtter.ExtBott.txt")->ExtBott
noBott$V4
noBott$V1
noBott$V2
noBott$V3
mean(noBott$V3)
mean(noBott$V4)
mean(noBott$V3)
mean(ExtBott$V3)
mean(Bott$V3)
library(ggplot2)
hist(noBott$V3)
hist(Bott$V3)
hist(Bott$V4)
hist(Bott$V3)
hist(ExtBott$V3)
wilcox.test(ExtBott$V3,Bott$V3)
wilcox.test(ExtBott$V3,NoBott$V3)
wilcox.test(ExtBott$V3,noBott$V3)
wilcox.test(ExtBott$V1,NoBott$V1)
wilcox.test(ExtBott$V1,noBott$V1)
Bott$V4
wilcox.test(ExtBott$V4,noBott$V4)
hist(ExtBott$V4,noBott$V4)
wilcox.text(ExtBott$V4,noBott$V4)
wilcox.test(ExtBott$V4,noBott$V4)
wilcox.test(ExtBott$V4,Bott$V4)
hist(ExtBott$V4)
hist(Bott$V4)
plot(Bott$V1,Bott$V4)
plot(Bott$V1,abs(Bott$V4))
plot(Bott$V1,log(abs(Bott$V4)))
plot(log(Bott$V1),log(abs(Bott$V4)))
plot(Bott$V1,log(abs(Bott$V4)))
plot(noBott$V1,log(abs(noBott$V4)))
points(Bott$V1,log(abs(Bott$V4)),col='red')
points(ExtBott$V1,log(abs(ExtBott$V4)),col='blue')
ExtBott$V4
abs(ExtBott$V4)
log(abs(ExtBott$V4))
hist(ExtBott$V4)
hist(ExtBott$V3)
hist(Bott$V3)
hist(Bott$V4)
hist(Bott$V3)
hist(noBott$V3)
hist(ExtBott$V3)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->noBott
hist(noBott$V3)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->noBott
hist(noBott$V3)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->noBott
hist(noBott$V3)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->Bott
hist(Bott$V3)
mean(Bott$V3)
wilcox.test(Bott$V3,ExtBott$V3)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->Bott
wilcox.test(Bott$V3,ExtBott$V3)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.2.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.2.txt")->ExtBott
library(cowplot)
library(ggplot2)#
library(wesanderson)#
library(cowplot)
ggplot(Bott,aes(V1,V4))+geom_point(col='red')
ggplot(Bott,aes(V1,V4))+geom_point(col='red')+scale_axis_log_x()
ggplot(Bott,aes(V1,V4))+geom_point(col='red')+scale_x_continuous(trans='log2')
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.2.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.2.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
ggplot(Bott,aes(V1,V4))+geom_point(col='red')+scale_x_continuous(trans='log2')+scale_y_continuous(trans='log2')
ggplot(Bott,aes(V1,abs(V4)))+geom_point(col='red')+scale_x_continuous(trans='log2')+scale_y_continuous(trans='log2')
ggplot(Bott,aes(V1,V4)+geom_point(col='red')+scale_x_continuous(trans='log2')
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.2.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.2.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.2.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
ggplot(Bott,aes(V1,V4)+geom_point(col='red')+scale_x_continuous(trans='log2')
ggplot(Bott,aes(V1,V4))+geom_point(col='red')+scale_x_continuous(trans='log2')
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott
Bott
noBott
NoBott
ExtBott
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott
ggplot(Bott,aes(V1,V4))+geom_point(col='red')+scale_x_continuous(trans='log2')
ggplot(NoBott,aes(V1,V4))+geom_point(col='red')+scale_x_continuous(trans='log2')
hist(Bott$V4)
hist(Bott$V3)
hist(NoBott$V3)
hist(ExtBott$V3)
wilcox.test(Bott$V3,NoBott$V3)
wilcox.test(Bott$V3,ExtBott$V3)
df <-data.frame(N=Bott$V4,model="Bottleneck")
df
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V4,model="Bottleneck")#
df<rbind(df,data.frame(N=NoBott$V4,model="No bottleneck"))#
df<rbind(df,data.frame(N=ExtBott$V4,model="Extreme bottleneck"))
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V4,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V4,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V4,model="Extreme bottleneck"))
ggplot(df,aes(N,model))+geom_boxplot()
ggplot(df,aes(model,N))+geom_boxplot()
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
ggplot(df,aes(model,N))+geom_boxplot()
ggplot(df,aes(model,N))+geom_boxplot(fill='skyblue')
ggplot(df,aes(model,N))+geom_boxplot(fill='skyblue')+ylab(expression(italic(N) *" (population size)")) + xlab("")
ggplot(df,aes(model,N))+geom_violin(fill='skyblue')+ylab(expression(italic(N) *" (population size)")) + xlab("")
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
ggplot(df,aes(model,N))+geom_violin(fill=model)+ylab(expression(italic(N) *" (population size)")) + xlab("")
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
ggplot(df,aes(model,N,fill=model))+geom_violin()+ylab(expression(italic(N) *" (population size)")) + xlab("")
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")
ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")+scale_color_discrete(wes_palette="rushmore")
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")+wes_palette("rushmore")
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")+scale_color_manual(colors=wes_palette("darjeeling1"))
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")+scale_color_manual(colors=wes_palette("Darjeeling1"))
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")+scale_color_discrete(colors=wes_palette("Darjeeling1"))
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")+scale_color_discrete(values=wes_palette("Darjeeling1"))
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")
plA<-plA+scale_color_discrete(values=wes_palette("Darjeeling1"))
plA<-plA+scale_color_manual(values=wes_palette("Darjeeling1"))
plA
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_color_manual(values=wes_palette("Darjeeling1"))
plA
plA<-plA+scale_fill_manual(values=wes_palette("Darjeeling1"))
plA
plA<-plA+scale_fill_manual(values=wes_palette("Darjeeling2"))
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("Darjeeling2"))#
#
read.table()
plA
plA<-plA+scale_fill_manual(values=wes_palette("Bottlerocket2"))
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("Bottlerocket2"))#
#
read.table()
plA
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("BottleRocket2"))
plA
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))
plA
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc
ggplot(MCMC,aes(LeftYears.reasonable,Ne.reasonable))+geom_step()
ggplot(McMc,aes(LeftYears.reasonable,Ne.reasonable))+geom_step()
McMc
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt",header=T)->McMc
McMc
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc
ggplot(McMc,aes(LeftYears.reasonable,Ne.reasonable))+geom_step()
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
#
ggplot(McMc,aes(V2,V1))+geom_step()
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continous(trans="log10")
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10")
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10")+scale_y_continuous(trans="log10")
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10",limits=c("3,000","10,000","30,000","100,000"))+scale_y_continuous(trans="log10")
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10",limits=c(3000,10000,30000,100000))+scale_y_continuous(trans="log10")
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10",limits=c(3000,10000,30000,100000))+scale_y_continuous(trans="log10",limits=c(1000,10000,100000))
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10",limits=c(3000,10000,30000,100000)+scale_y_continuous(trans="log10",limits=c(1000,10000,100000))
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10",limits=c(3000,10000,30000,100000))+scale_y_continuous(trans="log10",limits=c(1000,10000,100000))
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10")+scale_y_continuous(trans="log10")
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10")+scale_y_continuous(trans="log10")+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
library(scales)
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10")+scale_y_continuous(trans="log10")+ylab(expression(italic(N) * " (population size)"),labels=comma)+xlab(expression(italic(T) * " (years)"))
ggplot(McMc,aes(V2,V1))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
McMcAll<-data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="No Bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Extreme Bottleneck"))
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter_NoBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter_ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="No Bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Extreme Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(V2,V1,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="No Bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Extreme Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(V2,V1,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
plB
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="No Bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Extreme Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
plB
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No Bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
plB
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcXxtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McM$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McM$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))
plB
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))
plB
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))+theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),#
panel.grid.minor = element_blank()
)
plB
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step()+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))+theme_bw() + theme(panel.grid.major = element_blank(),#
panel.grid.minor = element_blank())
plB
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=2)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))
plB
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=1.3)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))
plB
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))
plB
plot_grid(plB,plA,labels="A","B")
plot_grid(plB,plA,labels="A","B",ncol=1)
plot_grid(plB,plA,labels=c("A","B"),ncol=1)
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))#
plB<-plB+geom_line(data=McMc,aes(time,size,color=wes_palette("GrandBudapest2")[1]))
plB
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))#
plB<-plB+geom_line(data=McMc,aes(V2,V1,color=wes_palette("GrandBudapest2")[1]))
plB
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))#
plB<-plB+geom_step(data=McMc,aes(V2,V1,color=wes_palette("GrandBudapest2")[1]))#
#
plot_grid(plB,plA,labels=c("A","B"),ncol=1)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))#
plB<-plB+geom_step(data=McMc,aes(V2,V1,color=wes_palette("GrandBudapest2")[1]),lwd=0.8)#
#
plot_grid(plB,plA,labels=c("A","B"),ncol=1)
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"),breaks=c(wes_palette("GrandBudapest2")[3],wes_palette("GrandBudapest2")[2],wes_palette("GrandBudapest2")[1]))
plB
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"),breaks=c(wes_palette("GrandBudapest2")[3],wes_palette("GrandBudapest2")[2],wes_palette("GrandBudapest2")[1]))#
plB<-plB+geom_step(data=McMc,aes(V2,V1,color=wes_palette("GrandBudapest2")[1]),lwd=0.8)
plot_grid(plB,plA,labels=c("A","B"),ncol=1)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"),breaks=c(wes_palette("GrandBudapest2")[3],wes_palette("GrandBudapest2")[2],wes_palette("GrandBudapest2")[1]))#
plB<-plB+geom_step(data=McMc,aes(V2,V1,color=wes_palette("GrandBudapest2")[1]),lwd=0.8)#
#
plot_grid(plB,plA,labels=c("A","B"),ncol=1)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))#
plB<-plB+geom_step(data=McMc,aes(V2,V1,color=wes_palette("GrandBudapest2")[1]),lwd=0.8)#
#
plot_grid(plB,plA,labels=c("A","B"),ncol=1)
read.table("~/projects/alice/aliceSimsMasters/SSotter.Bott.3.txt")->Bott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.NoBott.3.txt")->NoBott#
read.table("~/projects/alice/aliceSimsMasters/SSotter.ExtBott.3.txt")->ExtBott#
#
library(ggplot2)#
library(wesanderson)#
library(cowplot)#
library(scales)#
#
df <-data.frame(N=Bott$V3,model="Bottleneck")#
df<-rbind(df,data.frame(N=NoBott$V3,model="No bottleneck"))#
df<-rbind(df,data.frame(N=ExtBott$V3,model="Extreme bottleneck"))#
#
plA<-ggplot(df,aes(model,N,fill=model))+geom_boxplot()+ylab(expression(italic(N) *" (population size)")) + xlab("")+theme(legend.position="none")#
plA<-plA+scale_fill_manual(values=wes_palette("GrandBudapest2"))#
#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.txt")->McMc#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.noBott.txt")->McMcNoBott#
read.table("~/projects/alice/sea_otter_data/MSMC_sea_otter.ExtBott.txt")->McMcExtBott#
#
McMcAll<-data.frame(time=McMcNoBott$V2,size=McMcNoBott$V1,model="No bottleneck")#
McMcAll<-rbind(McMcAll, data.frame(time=McMcExtBott$V2,size=McMcExtBott$V1,model="Extreme bottleneck"))#
McMcAll<-rbind(McMcAll, data.frame(time=McMc$V2,size=McMc$V1,model="Bottleneck"))#
#
plB<-ggplot(McMcAll,aes(time,size,color=model))+geom_step(lwd=0.8)+scale_x_continuous(trans="log10",labels=comma)+scale_y_continuous(trans="log10",labels=comma)+ylab(expression(italic(N) * " (population size)"))+xlab(expression(italic(T) * " (years)"))+scale_color_manual(values=wes_palette("GrandBudapest2"))#
#
plot_grid(plB,plA,labels=c("A","B"),ncol=1)
ggsave("~/projects/aliceSimsMasters/bottleneckModels.pdf",width=7.5,height=5.5)
ggsave("~/projects/alice/aliceSimsMasters/bottleneckModels.pdf",width=7.5,height=5.5)
plot_grid(plB,plA,labels=c("A","B"),ncol=1)#
ggsave("~/projects/alice/aliceSimsMasters/bottleneckModels.pdf",width=7.5,height=5.5)#
ggsave("~/projects/alice/aliceSimsMasters/bottleneckModels.png",width=7.5,height=5.5)
plot_grid(plB,plA,labels=c("A","B"),ncol=1)#
ggsave("~/projects/alice/aliceSimsMasters/bottleneckModels.pdf",width=7.5,height=5)#
ggsave("~/projects/alice/aliceSimsMasters/bottleneckModels.png",width=7.5,height=5)
# max change in abundance / year in data is (1409-504)/(18-14) = 226.25#
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
#
plotAndGetMaxSlope<-function(i) {	#
#
  read.table(paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  scan(paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  # if epidemic is shorter than actual, skip#
  if(length(t$V1) < 10 ) {#
  	return (NA)#
  }#
  #plot(t$V1#
  len=min(length(t$V1),1000)#
  yvals = (t$V1+t$V2)[1:len]#
  popSize<-data.frame(x=seq(1,len),y=yvals)#
#
   M<-nls(y~y0/(1+exp(-r*(x-x0)))+ym, start=list(r=0.2,y0=-(max(yvals)),x0=20,ym=max(yvals)),data=popSize,trace=FALSE,lower=c(0.01,-10000,0.01,0.01),algorithm="port"#
,control = nls.control(minFactor = 1/10000000,maxiter=1000,warnOnly=TRUE))#
  M.df<-data.frame(x=seq(1,len))#
#
  #print (coef(M)[1])#
  #print(coef(M)[2])#
  #print(coef(M)[3])#
  #print(coef(M)[4])#
#
  # y = a / (1 + exp(-b *(x-x0))) + c#
  M.df$y<-coef(M)[2]/(1+exp(-coef(M)[1]*(M.df$x-coef(M)[3])))+coef(M)[4]#
#
  # Deriv is (a b E^(b (x + x0)))/(E^(b x) + E^(b x0))^2 which is maximized at x0, with a value of a*b/4#
  myMax = c(t(t(abs(coef(M)[2]*coef(M)[1]/4))))#
  #if(myMax > 100) {#
  #  print(myMax)#
    #print(coef(M)[3])#
    #p<-ggplot(data=popSize,aes(x,y),alpha=0.5)+geom_point()+ylim(c(0,2500))+geom_line(data=M.df,col='red',size=0.7)#
    #p+xlim(1,len)#
    #print(p)#
  #}#
  return(data.frame(m=myMax,a=as.numeric(params[2]),b=as.numeric(params[3])))#
}
data <-data.frame()#
emp<-0#
for ( i in seq(1,15000)) {#
	m<-plotAndGetMaxSlope(i)#
	if(is.na(m)) {#
		emp<-emp+1#
	} else {#
	    data<-rbind(data,m)#
	}#
}#
#
data_plot<-data[data$m<300,]
pl1<-ggplot(data_plot,aes(a,b))+ geom_bin2d(binwidth=c(1,1),aes(fill=cut(m,seq(0,300,15))))+scale_fill_manual(values=wes_palette("Zissou1",21,type="continuous"))
myPdf<-function(df,at,bt,bw) {#
	if (length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m) == 0) {#
		return(0)#
	}#
	return(length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m)/length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m))#
}#
#
pdf<-data.frame()#
for (i in seq(0,19,1)) {#
	 for (j in seq(0,19,1)) {#
	     pdf<-rbind(pdf,data.frame(a=i,b=j,f=myPdf(data_plot,i,j,1)))    	#
	 } #
}
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='plasma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_color_viridis(option='plasma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))
library(ggplot2)
library(cowplot)
library(wesanderson)
library(viridis)
install.packages(viridis)
install.packages("viridis")
library(viridis)
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='plasma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))
pl2
cowplot(pl1,pl2,labels=c("A","B"))
plot_grid(pl1,pl2,labels=c("A","B"))
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
#
# get correlations between Fh and unseen variables#
#
read.table("~/projects/bootslab/anther_smut/simAnthSmut/col_corr.txt")->cc#
# Fh and Vh#
plot(cc$V1,cc$V3)#
lm(cc$V3~cc$V1)#
# Fh and Vd#
plot(cc$V1,cc$V4)#
lm(cc$V4~cc$V1)#
# Fh and J#
plot(cc$V1,cc$V5)#
lm(cc$V5~cc$V1)#
# get perf of inference assuming we know all relevant variables#
#
read.table("~/projects/bootslab/anther_smut/simAnthSmut/simPerf.BestCase.txt")->sB#
read.table("~/projects/bootslab/anther_smut/simAnthSmut/simPerf.Biased.txt")->sF#
#
sF<-sF[sF$V15!="Inf",]#
#
make_df<-function(s) {#
	df<-data.frame()#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="migSeeds",est=(s$V1[i]-s$V6[i])/s$V6[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="migSpores",est=(s$V2[i]-s$V7[i])/s$V7[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="betaF",est=(s$V3[i]-s$V8[i])/s$V8[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="betaV",est=(s$V4[i]-s$V9[i])/s$V9[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="betaJ",est=(s$V5[i]-s$V10[i])/s$V10[i]))#
	}#
	return(df)#
}#
#
df<-make_df(sB)#
#
plA<-ggplot(df,aes(x,est,fill=as.factor(x)))+geom_boxplot()+scale_fill_manual(values=wes_palette("Darjeeling1"))+geom_hline(yintercept=0,lty=3)+xlab("Parameter")+ylab("Bias")+theme(legend.position="none")+ylim(c(-1,5))#
#
# now assuming we know only Fh and Fd#
#
df<-make_df(sF)#
#
plB<-ggplot(df,aes(x,est,fill=as.factor(x)))+geom_boxplot()+scale_fill_manual(values=wes_palette("Darjeeling1"))+geom_hline(yintercept=0,lty=3)+xlab("Parameter")+ylab("Bias")+theme(legend.position="none")+ylim(c(-1,5))#
#
# now assuming we can't use Vn and Vd and j in the prob calcs#
#
plot_grid(plA,plB,labels=c("A","B"))
read.table("~/projects/bootslabOld/anther_smut/simAnthSmut/simPerf.BestCase.txt")->sB
read.table("~/projects/bootslabOld/anther_smut/simAnthSmut/simPerf.Biased.txt")->sF
sF<-sF[sF$V15!="Inf",]#
#
make_df<-function(s) {#
	df<-data.frame()#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="migSeeds",est=(s$V1[i]-s$V6[i])/s$V6[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="migSpores",est=(s$V2[i]-s$V7[i])/s$V7[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="betaF",est=(s$V3[i]-s$V8[i])/s$V8[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="betaV",est=(s$V4[i]-s$V9[i])/s$V9[i]))#
	}#
	for(i in seq(1,length(s$V1))) {#
		df<-rbind(df,data.frame(x="betaJ",est=(s$V5[i]-s$V10[i])/s$V10[i]))#
	}#
	return(df)#
}#
#
df<-make_df(sB)#
#
plA<-ggplot(df,aes(x,est,fill=as.factor(x)))+geom_boxplot()+scale_fill_manual(values=wes_palette("Darjeeling1"))+geom_hline(yintercept=0,lty=3)+xlab("Parameter")+ylab("Bias")+theme(legend.position="none")+ylim(c(-1,5))#
#
# now assuming we know only Fh and Fd#
#
df<-make_df(sF)#
#
plB<-ggplot(df,aes(x,est,fill=as.factor(x)))+geom_boxplot()+scale_fill_manual(values=wes_palette("Darjeeling1"))+geom_hline(yintercept=0,lty=3)+xlab("Parameter")+ylab("Bias")+theme(legend.position="none")+ylim(c(-1,5))#
#
# now assuming we can't use Vn and Vd and j in the prob calcs#
#
plot_grid(plA,plB,labels=c("A","B"))
# abundance over time#
#
read.table("~/projects/bootslab/anther_smut/simAnthSmut/abundanceDensOnly.txt")->dens#
read.table("~/projects/bootslab/anther_smut/simAnthSmut/abundanceDensOnlyNoQual.txt")->dens#
read.table("~/projects/bootslab/anther_smut/simAnthSmut/abundanceDisInfParm.txt")->infer#
read.table("~/projects/bootslab/anther_smut/simAnthSmut/abundanceFreqOnly.txt")->freq#
#
plA<-ggplot(infer,aes(seq(1,980),V6))+geom_line(col='red')#
plB<-ggplot(freq,aes(seq(1,980),V6))+geom_line(col='red')#
#
plot_grid(plA,plB)
matrix([[0, 1.05, 1.05],[0.8, 0, 0],[0, 0.8, 0]])
matrix([0, 1.05, 1.05],[0.8, 0, 0],[0, 0.8, 0])
matrix(c([0, 1.05, 1.05],[0.8, 0, 0],[0, 0.8, 0]))
matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),nrow=3,ncol=3)
eig(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),nrow=3,ncol=3))
eigen(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),nrow=3,ncol=3))
eigen(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3))
matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3)
t(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3))
eigen(t(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3)))
t(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3)) %*% matrix(c(8.4,0,6.4),ncol=1)
t(matrix(c(0, 1.05, 1.05, 0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3)) %*% matrix(c(010,0,0),ncol=1)
t(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3)) %*% matrix(c(8.4,0,6.4),ncol=1)
t(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3)) %*% matrix(c(6.72,6.72,0),ncol=1)
14.8/8
t(matrix(c(0, 2, 0, 0.5), ncol=2,nrow=2))
t(matrix(c(0, 2, 0.5, 0.), ncol=2,nrow=2))
eigen(t(matrix(c(0, 2, 0.5, 0.), ncol=2,nrow=2)))
sum(t(matrix(c(0, 1.05, 1.05,0.8, 0, 0,0, 0.8, 0),ncol=3,nrow=3)) %*% matrix(c(6.72,6.72,0),ncol=1))
17.80/13.448
17.80/13.44
# max change in abundance / year in data is (1409-504)/(18-14) = 226.25#
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
library(viridis)#
#
plotAndGetMaxSlope<-function(i) {	#
#
  read.table(paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  scan(paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  # if epidemic is shorter than actual, skip#
  if(length(t$V1) < 10 ) {#
  	return (NA)#
  }#
  #plot(t$V1#
  len=min(length(t$V1),1000)#
  yvals = (t$V1+t$V2)[1:len]#
  popSize<-data.frame(x=seq(1,len),y=yvals)#
#
   M<-nls(y~y0/(1+exp(-r*(x-x0)))+ym, start=list(r=0.2,y0=-(max(yvals)),x0=20,ym=max(yvals)),data=popSize,trace=FALSE,lower=c(0.01,-10000,0.01,0.01),algorithm="port"#
,control = nls.control(minFactor = 1/10000000,maxiter=1000,warnOnly=TRUE))#
  M.df<-data.frame(x=seq(1,len))#
#
  #print (coef(M)[1])#
  #print(coef(M)[2])#
  #print(coef(M)[3])#
  #print(coef(M)[4])#
#
  # y = a / (1 + exp(-b *(x-x0))) + c#
  M.df$y<-coef(M)[2]/(1+exp(-coef(M)[1]*(M.df$x-coef(M)[3])))+coef(M)[4]#
#
  # Deriv is (a b E^(b (x + x0)))/(E^(b x) + E^(b x0))^2 which is maximized at x0, with a value of a*b/4#
  myMax = c(t(t(abs(coef(M)[2]*coef(M)[1]/4))))#
  #if(myMax > 100) {#
  #  print(myMax)#
    #print(coef(M)[3])#
    #p<-ggplot(data=popSize,aes(x,y),alpha=0.5)+geom_point()+ylim(c(0,2500))+geom_line(data=M.df,col='red',size=0.7)#
    #p+xlim(1,len)#
    #print(p)#
  #}#
  return(data.frame(m=myMax,a=as.numeric(params[2]),b=as.numeric(params[3])))#
}#
#
data <-data.frame()#
emp<-0#
for ( i in seq(1,15000)) {#
	m<-plotAndGetMaxSlope(i)#
	if(is.na(m)) {#
		emp<-emp+1#
	} else {#
	    data<-rbind(data,m)#
	}#
}#
#
data_plot<-data[data$m<300,]#
#
pl1<-ggplot(data_plot,aes(a,b))+ geom_bin2d(binwidth=c(1,1),aes(fill=cut(m,seq(0,300,15))))+scale_fill_manual(values=wes_palette("Zissou1",21,type="continuous"))#
myPdf<-function(df,at,bt,bw) {#
	if (length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m) == 0) {#
		return(0)#
	}#
	return(length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m)/length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m))#
}#
#
pdf<-data.frame()#
for (i in seq(0,19,1)) {#
	 for (j in seq(0,19,1)) {#
	     pdf<-rbind(pdf,data.frame(a=i,b=j,f=myPdf(data_plot,i,j,1)))    	#
	 } #
}#
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='plasma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))#
#
plot_grid(pl1,pl2,labels=c("A","B"))
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
library(viridis)#
#
get_data <-function(betaF,betaVJ,index,thresh) {#
	file = paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsForPlot/sim.betaF.",betaF,".betaVJ.",betaVJ,".txt",sep="")#
	read.table(file)->te#
	#print (te[,index])#
	me = mean(te[,index][te[,10]>thresh])#
	se = sd(te[,index][te[,10]>thresh])/sqrt(length(te[,index][te[,10]>thresh]))#
	return(list(me=me,su = me+se,sd=me-se))#
}#
#
index_list<-c(0.05,0.1,0.2,0.5,1,2,5,10,20)#
thresh<-2#
#
# first, disease persistence#
#
VJonly<-c()#
VJonlySU<-c()#
VJonlySD<-c()#
for (i in index_list) {#
 VJonly<-c(VJonly,get_data(0,i,10,thresh)$me)#
 VJonlySU<-c(VJonlySU,get_data(0,i,10,thresh)$su)#
 VJonlySD<-c(VJonlySD,get_data(0,i,10,thresh)$sd)#
#
}#
#
Fonly<-c()#
FonlySU<-c()#
FonlySD<-c()#
for (i in index_list) {#
 Fonly<-c(Fonly,get_data(i,0,10,thresh)$me)#
 FonlySU<-c(FonlySU,get_data(i,0,10,thresh)$su)#
 FonlySD<-c(FonlySD,get_data(i,0,10,thresh)$sd)#
}#
#
VJfixandF<-c()#
VJfixandFSU<-c()#
VJfixandFSD<-c()#
for (i in index_list) {#
 VJfixandF<-c(VJfixandF,get_data(i,1,10,thresh)$me)#
 VJfixandFSU<-c(VJfixandFSU,get_data(i,1,10,thresh)$su)#
 VJfixandFSD<-c(VJfixandFSD,get_data(i,1,10,thresh)$sd)#
}#
#
FfixandVJ<-c()#
FfixandVJSU<-c()#
FfixandVJSD<-c()#
for (i in index_list) {#
 FfixandVJ<-c(FfixandVJ,get_data(1,i,10,thresh)$me)#
 FfixandVJSU<-c(FfixandVJSU,get_data(1,i,10,thresh)$su)#
 FfixandVJSD<-c(FfixandVJSD,get_data(1,i,10,thresh)$sd)#
}#
df<-data.frame(x=index_list,y=VJonly,yd=VJonlySD,yu=VJonlySU,type=rep("VJ",9))#
df<-rbind(df,data.frame(x=index_list,y=Fonly,yd=FonlySD,yu=FonlySU,type=rep("F",9)))#
df<-rbind(df,data.frame(x=index_list,y=FfixandVJ,yd=FfixandVJSD,yu=FfixandVJSU,type=rep("F_VJ",9)))#
df<-rbind(df,data.frame(x=index_list,y=VJfixandF,yd=VJfixandFSD,yu=VJfixandFSU,type=rep("VJ_F",9)))#
plA<-ggplot(df,aes(x,y,col=type))+geom_point()+geom_line()+scale_x_log10(breaks=c(0.05,0.2,1,5,20))+scale_y_log10(breaks=c(5,10,50,100,500,1000),limits=c(5,1000))+geom_ribbon(aes(ymin=yd,ymax=yu,fill=type,col=type),linetype=0,alpha=0.3)+scale_color_manual(values=wes_palette("Moonrise3"))+scale_fill_manual(values=wes_palette("Moonrise3"))+xlab(expression(beta[rel]))+ylab(expression(italic(T) * " (duration)"))+theme(legend.position="NA")#
# next, extinction#
#
VJonly<-c()#
VJonlySU<-c()#
VJonlySD<-c()#
for (i in index_list) {#
 VJonly<-c(VJonly,get_data(0,i,11,thresh)$me)#
 VJonlySU<-c(VJonlySU,get_data(0,i,11,thresh)$su)#
 VJonlySD<-c(VJonlySD,get_data(0,i,11,thresh)$sd)#
#
}#
#
Fonly<-c()#
FonlySU<-c()#
FonlySD<-c()#
for (i in index_list) {#
 Fonly<-c(Fonly,get_data(i,0,11,thresh)$me)#
 FonlySU<-c(FonlySU,get_data(i,0,11,thresh)$su)#
 FonlySD<-c(FonlySD,get_data(i,0,11,thresh)$sd)#
}#
#
VJfixandF<-c()#
VJfixandFSU<-c()#
VJfixandFSD<-c()#
for (i in index_list) {#
 VJfixandF<-c(VJfixandF,get_data(i,1,11,thresh)$me)#
 VJfixandFSU<-c(VJfixandFSU,get_data(i,1,11,thresh)$su)#
 VJfixandFSD<-c(VJfixandFSD,get_data(i,1,11,thresh)$sd)#
}#
#
FfixandVJ<-c()#
FfixandVJSU<-c()#
FfixandVJSD<-c()#
for (i in index_list) {#
 FfixandVJ<-c(FfixandVJ,get_data(1,i,11,thresh)$me)#
 FfixandVJSU<-c(FfixandVJSU,get_data(1,i,11,thresh)$su)#
 FfixandVJSD<-c(FfixandVJSD,get_data(1,i,11,thresh)$sd)#
}#
#
df<-data.frame(x=index_list,y=VJonly,yd=VJonlySD,yu=VJonlySU,type=rep("VJ",9))#
df<-rbind(df,data.frame(x=index_list,y=Fonly,yd=FonlySD,yu=FonlySU,type=rep("F",9)))#
df<-rbind(df,data.frame(x=index_list,y=FfixandVJ,yd=FfixandVJSD,yu=FfixandVJSU,type=rep("F_VJ",9)))#
df<-rbind(df,data.frame(x=index_list,y=VJfixandF,yd=VJfixandFSD,yu=VJfixandFSU,type=rep("VJ_F",9)))#
plB<-ggplot(df,aes(x,y,col=type))+geom_point()+geom_line()+scale_x_log10(breaks=c(0.05,0.2,1,5,20))+geom_ribbon(aes(ymin=yd,ymax=yu,fill=type,col=type),linetype=0,alpha=0.3)+scale_color_manual(values=wes_palette("Moonrise3"),name="",#
                       labels=c(expression(beta[F] * " = 0, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 0"), expression(beta[F] * " = 1, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 1")))+scale_fill_manual(values=wes_palette("Moonrise3"),name="",#
                       labels=c(expression(beta[F] * " = 0, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 0"), expression(beta[F] * " = 1, " * beta[VJ] * " = " * beta[rel] ), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 1")))+xlab(expression(beta[rel]))+ylab(expression(italic(P) * " (persistence)"))#
# max change in abundance / year in data is (1409-504)/(18-14) = 226.25#
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
#
plotAndGetMaxSlope<-function(i) {	#
#
  read.table(paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  scan(paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  # if epidemic is shorter than actual, skip#
  if(length(t$V1) < 10 ) {#
  	return (NA)#
  }#
  len=min(length(t$V1),1000)#
  yvals = (t$V1+t$V2)[1:len]#
  popSize<-data.frame(x=seq(1,len),y=yvals)#
#
   M<-nls(y~y0/(1+exp(-r*(x-x0)))+ym, start=list(r=0.2,y0=-(max(yvals)),x0=20,ym=max(yvals)),data=popSize,trace=FALSE,lower=c(0.01,-10000,0.01,0.01),algorithm="port"#
,control = nls.control(minFactor = 1/10000000,maxiter=1000,warnOnly=TRUE))#
  M.df<-data.frame(x=seq(1,len))#
  # y = a / (1 + exp(-b *(x-x0))) + c#
  M.df$y<-coef(M)[2]/(1+exp(-coef(M)[1]*(M.df$x-coef(M)[3])))+coef(M)[4]#
#
  # Deriv is (a b E^(b (x + x0)))/(E^(b x) + E^(b x0))^2 which is maximized at x0, with a value of a*b/4#
  myMax = c(t(t(abs(coef(M)[2]*coef(M)[1]/4))))#
  #if(myMax > 100) {#
    #print(myMax)#
    #print(coef(M)[3])#
    #p<-ggplot(data=popSize,aes(x,y),alpha=0.5)+geom_point()+ylim(c(0,2500))+geom_line(data=M.df,col='red',size=0.7)#
    #p+xlim(1,len)#
    #print(p)#
  #}#
  tot_final = sum(t[len,][1:5],na.rm=T)#
  print(tot_final)#
  if(tot_final > 0) {#
  	tot_final = 1#
  	}#
  return(data.frame(m=myMax,a=as.numeric(params[2]),b=as.numeric(params[3]),l=len,t=tot_final))#
}#
#
data <-data.frame()#
emp<-0#
for ( i in seq(1,15000)) {#
	m<-plotAndGetMaxSlope(i)#
	if(is.na(m)) {#
		emp<-emp+1#
	} else {#
	    data<-rbind(data,m)#
	}#
}#
#
data_plot<-data[data$m<300,]#
#
pl1<-ggplot(data_plot,aes(a,b))+ geom_bin2d(binwidth=c(1,1),aes(fill=cut(m,seq(0,300,15))))+scale_fill_manual(values=wes_palette("Zissou1",21,type="continuous"))#
myPdf<-function(df,at,bt,bw) {#
	if (length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m) == 0) {#
		return(0)#
	}#
	return(length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m)/length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m))#
}#
#
myldf<-function(df,at,bt,bw) {#
	return(mean(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw ,]$t))#
}#
pdf<-data.frame()#
for (i in seq(0,19,1)) {#
	 for (j in seq(0,19,1)) {#
	     pdf<-rbind(pdf,data.frame(a=i,b=j,f=myPdf(data_plot,i,j,1),t=myldf(data_plot,i,j,1)))    	#
	 } #
}#
#
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='viridis',name=expression(italic(F)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))#
#
pl3<-ggplot(pdf,aes(a,b,color=t))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='magma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))#
plot_grid(pl2,pl3,labels=c("A","B"),rel_widths=c(1,1),ncol=2)#
ggsave("~/projects/bootslab/anther_smut/simAnthSmut/figures/figSim.pdf",width=7.5*1.3,height=2.8*1.3)
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
setwd("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/")#
#
read.table("TheorExpSims/All.freq.1.dens.1.txt")->tfd      # both freq dependent and dens trans#
read.table("TheorExpSims/All.freq.1.dens.0.txt")->tf   # freq dependent#
read.table("TheorExpSims/All.freq.0.dens.1.txt")->td   # dens dependent #
#
# FD#
#
meansFD<-c()#
stdFD<-c()#
meansFDPrev<-c()#
stdFDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansFD<-c(meansFD,mean(tfd[,i]+tfd[,i+100],na.rm=T))#
	stdFD<-c(stdFD,sd(tfd[,i]+tfd[,i+100],na.rm=T))#
}#
plot(meansFD)#
for (i in seq(101,200)) {#
	meansFDPrev<-c(meansFDPrev,mean(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
	stdFDPrev<-c(stdFDPrev,sd(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
}#
plot(meansFD,meansFDPrev)#
#
# Dens#
#
meansD<-c()#
stdD<-c()#
meansDPrev<-c()#
stdDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansD<-c(meansD,mean(td[,i]+td[,i+100],na.rm=T))#
	stdD<-c(stdD,sd(td[,i]+td[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansDPrev<-c(meansDPrev,mean(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
	stdDPrev<-c(stdDPrev,sd(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
}#
plot(meansD,meansDPrev)#
#
# Freq#
#
meansF<-c()#
stdF<-c()#
meansFPrev<-c()#
stdFPrev<-c()#
for (i in seq(1,100)) {#
	meansF<-c(meansF,mean(tf[,i]+tf[,i+100],na.rm=T))#
	stdF<-c(stdF,sd(tf[,i]+tf[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansFPrev<-c(meansFPrev,mean(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
	stdFPrev<-c(stdFPrev,sd(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
}#
plot(meansF,meansFPrev)#
mydf<-data.frame(pos=c(seq(1,100),seq(1,100),seq(1,100)),abun=c(meansFD,meansD,meansF),prev=c(meansFDPrev,meansDPrev,meansFPrev),maxAbun<-c(meansFD+stdFD,meansD+stdD,meansF+stdF),minAbun<-c(pmax(meansFD-stdFD,0),pmax(meansD-stdD,0),pmax(meansF-stdF,0)),minPrev<-c(pmax(meansFDPrev-stdFDPrev,0),pmax(meansDPrev-stdDPrev,0),pmax(meansFPrev-stdFPrev,0)),maxPrev<-c(meansFDPrev+stdFDPrev,meansDPrev+stdDPrev,meansFPrev+stdFPrev),type=c(rep("both",100),rep("density-dependent",100),rep("frequency-dependent",100)))#
#
plA<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minAbun,ymax=maxAbun,fill=type),alpha=0.3)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Abundance")+geom_line(data=mydf,aes(pos,abun,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))#
#
plB<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Prevalence")+geom_line(data=mydf,aes(pos,prev,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+ylim(c(0,0.5))#
#
plC<-ggplot()+geom_ribbon(data=mydf,aes(x=abun,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"),name="")+xlab("abundance")+ylab("prevalence")+geom_line(data=mydf,aes(abun,prev,col=type),size=1)+scale_fill_manual(values=wes_palette("Darjeeling1"),name="")+xlim(c(0,7))+ylim(c(0,0.5))#
row1<-plot_grid(plA,plB,plC,ncol=3,labels=c("A","B","C"),rel_widths=c(1,1,1.6))#
#
# Now with real qual#
read.table("TheorExpSims/All.qual.freq.1.dens.1.txt")->tfd      # both freq dependent and dens trans#
read.table("TheorExpSims/All.qual.freq.1.dens.0.txt")->tf   # freq dependent#
read.table("TheorExpSims/All.qual.freq.0.dens.1.txt")->td   # dens dependent #
#
# FD#
#
meansFD<-c()#
stdFD<-c()#
meansFDPrev<-c()#
stdFDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansFD<-c(meansFD,mean(tfd[,i]+tfd[,i+100],na.rm=T))#
	stdFD<-c(stdFD,sd(tfd[,i]+tfd[,i+100],na.rm=T))#
}#
plot(meansFD)#
for (i in seq(101,200)) {#
	meansFDPrev<-c(meansFDPrev,mean(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
	stdFDPrev<-c(stdFDPrev,sd(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
}#
plot(meansFD,meansFDPrev)#
#
# Dens#
#
meansD<-c()#
stdD<-c()#
meansDPrev<-c()#
stdDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansD<-c(meansD,mean(td[,i]+td[,i+100],na.rm=T))#
	stdD<-c(stdD,sd(td[,i]+td[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansDPrev<-c(meansDPrev,mean(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
	stdDPrev<-c(stdDPrev,sd(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
}#
plot(meansD,meansDPrev)#
#
# Freq#
#
meansF<-c()#
stdF<-c()#
meansFPrev<-c()#
stdFPrev<-c()#
for (i in seq(1,100)) {#
	meansF<-c(meansF,mean(tf[,i]+tf[,i+100],na.rm=T))#
	stdF<-c(stdF,sd(tf[,i]+tf[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansFPrev<-c(meansFPrev,mean(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
	stdFPrev<-c(stdFPrev,sd(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
}#
plot(meansF,meansFPrev)#
mydf<-data.frame(pos=c(seq(1,100),seq(1,100),seq(1,100)),abun=c(meansFD,meansD,meansF),prev=c(meansFDPrev,meansDPrev,meansFPrev),maxAbun<-c(meansFD+stdFD,meansD+stdD,meansF+stdF),minAbun<-c(pmax(meansFD-stdFD,0),pmax(meansD-stdD,0),pmax(meansF-stdF,0)),minPrev<-c(pmax(meansFDPrev-stdFDPrev,0),pmax(meansDPrev-stdDPrev,0),pmax(meansFPrev-stdFPrev,0)),maxPrev<-c(meansFDPrev+stdFDPrev,meansDPrev+stdDPrev,meansFPrev+stdFPrev),type=c(rep("both",100),rep("density-dependent",100),rep("frequency-dependent",100)))#
#
plD<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minAbun,ymax=maxAbun,fill=type),alpha=0.3)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Abundance")+geom_line(data=mydf,aes(pos,abun,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))#
#
plE<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Prevalence")+geom_line(data=mydf,aes(pos,prev,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+ylim(c(0,0.5))#
#
plF<-ggplot()+geom_ribbon(data=mydf,aes(x=abun,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"),name="")+xlab("abundance")+ylab("prevalence")+geom_line(data=mydf,aes(abun,prev,col=type),size=1)+scale_fill_manual(values=wes_palette("Darjeeling1"),name="")+xlim(c(0,4.5))+ylim(c(0,0.5))#
row2<-plot_grid(plD,plE,plF,ncol=3,labels=c("D","E","F"),rel_widths=c(1,1,1.6))#
#
fin<-plot_grid(row1,row2,ncol=1)#
#
fin
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
setwd("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/")#
#
read.table("TheorExpSims/All.freq.1.dens.1.txt")->tfd      # both freq dependent and dens trans#
read.table("TheorExpSims/All.freq.1.dens.0.txt")->tf   # freq dependent#
read.table("TheorExpSims/All.freq.0.dens.1.txt")->td   # dens dependent #
#
# FD#
#
meansFD<-c()#
stdFD<-c()#
meansFDPrev<-c()#
stdFDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansFD<-c(meansFD,mean(tfd[,i]+tfd[,i+100],na.rm=T))#
	stdFD<-c(stdFD,sd(tfd[,i]+tfd[,i+100],na.rm=T))#
}#
plot(meansFD)#
for (i in seq(101,200)) {#
	meansFDPrev<-c(meansFDPrev,mean(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
	stdFDPrev<-c(stdFDPrev,sd(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
}#
plot(meansFD,meansFDPrev)#
#
# Dens#
#
meansD<-c()#
stdD<-c()#
meansDPrev<-c()#
stdDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansD<-c(meansD,mean(td[,i]+td[,i+100],na.rm=T))#
	stdD<-c(stdD,sd(td[,i]+td[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansDPrev<-c(meansDPrev,mean(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
	stdDPrev<-c(stdDPrev,sd(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
}#
plot(meansD,meansDPrev)#
#
# Freq#
#
meansF<-c()#
stdF<-c()#
meansFPrev<-c()#
stdFPrev<-c()#
for (i in seq(1,100)) {#
	meansF<-c(meansF,mean(tf[,i]+tf[,i+100],na.rm=T))#
	stdF<-c(stdF,sd(tf[,i]+tf[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansFPrev<-c(meansFPrev,mean(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
	stdFPrev<-c(stdFPrev,sd(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
}#
plot(meansF,meansFPrev)#
mydf<-data.frame(pos=c(seq(1,100),seq(1,100),seq(1,100)),abun=c(meansFD,meansD,meansF),prev=c(meansFDPrev,meansDPrev,meansFPrev),maxAbun<-c(meansFD+stdFD,meansD+stdD,meansF+stdF),minAbun<-c(pmax(meansFD-stdFD,0),pmax(meansD-stdD,0),pmax(meansF-stdF,0)),minPrev<-c(pmax(meansFDPrev-stdFDPrev,0),pmax(meansDPrev-stdDPrev,0),pmax(meansFPrev-stdFPrev,0)),maxPrev<-c(meansFDPrev+stdFDPrev,meansDPrev+stdDPrev,meansFPrev+stdFPrev),type=c(rep("both",100),rep("density-dependent",100),rep("frequency-dependent",100)))#
#
plA<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minAbun,ymax=maxAbun,fill=type),alpha=0.3)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Abundance")+geom_line(data=mydf,aes(pos,abun,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))#
#
plB<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Prevalence")+geom_line(data=mydf,aes(pos,prev,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+ylim(c(0,0.5))#
#
plC<-ggplot()+geom_ribbon(data=mydf,aes(x=abun,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"),name="")+xlab("abundance")+ylab("prevalence")+geom_line(data=mydf,aes(abun,prev,col=type),size=1)+scale_fill_manual(values=wes_palette("Darjeeling1"),name="")+xlim(c(0,7))+ylim(c(0,0.5))#
row1<-plot_grid(plA,plB,plC,ncol=3,labels=c("A","B","C"),rel_widths=c(1,1,1.6))#
#
# Now with real qual#
read.table("TheorExpSims/All.qual.freq.1.dens.1.txt")->tfd      # both freq dependent and dens trans#
read.table("TheorExpSims/All.qual.freq.1.dens.0.txt")->tf   # freq dependent#
read.table("TheorExpSims/All.qual.freq.0.dens.1.txt")->td   # dens dependent #
#
# FD#
#
meansFD<-c()#
stdFD<-c()#
meansFDPrev<-c()#
stdFDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansFD<-c(meansFD,mean(tfd[,i]+tfd[,i+100],na.rm=T))#
	stdFD<-c(stdFD,sd(tfd[,i]+tfd[,i+100],na.rm=T))#
}#
plot(meansFD)#
for (i in seq(101,200)) {#
	meansFDPrev<-c(meansFDPrev,mean(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
	stdFDPrev<-c(stdFDPrev,sd(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
}#
plot(meansFD,meansFDPrev)#
#
# Dens#
#
meansD<-c()#
stdD<-c()#
meansDPrev<-c()#
stdDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansD<-c(meansD,mean(td[,i]+td[,i+100],na.rm=T))#
	stdD<-c(stdD,sd(td[,i]+td[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansDPrev<-c(meansDPrev,mean(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
	stdDPrev<-c(stdDPrev,sd(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
}#
plot(meansD,meansDPrev)#
#
# Freq#
#
meansF<-c()#
stdF<-c()#
meansFPrev<-c()#
stdFPrev<-c()#
for (i in seq(1,100)) {#
	meansF<-c(meansF,mean(tf[,i]+tf[,i+100],na.rm=T))#
	stdF<-c(stdF,sd(tf[,i]+tf[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansFPrev<-c(meansFPrev,mean(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
	stdFPrev<-c(stdFPrev,sd(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
}#
plot(meansF,meansFPrev)#
mydf<-data.frame(pos=c(seq(1,100),seq(1,100),seq(1,100)),abun=c(meansFD,meansD,meansF),prev=c(meansFDPrev,meansDPrev,meansFPrev),maxAbun<-c(meansFD+stdFD,meansD+stdD,meansF+stdF),minAbun<-c(pmax(meansFD-stdFD,0),pmax(meansD-stdD,0),pmax(meansF-stdF,0)),minPrev<-c(pmax(meansFDPrev-stdFDPrev,0),pmax(meansDPrev-stdDPrev,0),pmax(meansFPrev-stdFPrev,0)),maxPrev<-c(meansFDPrev+stdFDPrev,meansDPrev+stdDPrev,meansFPrev+stdFPrev),type=c(rep("both",100),rep("density-dependent",100),rep("frequency-dependent",100)))#
#
plD<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minAbun,ymax=maxAbun,fill=type),alpha=0.3)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Abundance")+geom_line(data=mydf,aes(pos,abun,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))#
#
plE<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Prevalence")+geom_line(data=mydf,aes(pos,prev,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+ylim(c(0,0.5))#
#
plF<-ggplot()+geom_ribbon(data=mydf,aes(x=abun,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"),name="")+xlab("abundance")+ylab("prevalence")+geom_line(data=mydf,aes(abun,prev,col=type),size=1)+scale_fill_manual(values=wes_palette("Darjeeling1"),name="")+xlim(c(0,4.5))+ylim(c(0,0.5))#
row2<-plot_grid(plD,plE,plF,ncol=3,labels=c("D","E","F"),rel_widths=c(1,1,1.6))#
#
fin<-plot_grid(row1,row2,ncol=1)#
#
fin#
#
ggsave("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/figures/Fig5.pdf",fin,width=14,height=7)
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
setwd("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/")#
#
read.table("TheorExpSims/All.freq.1.dens.1.txt")->tfd      # both freq dependent and dens trans#
read.table("TheorExpSims/All.freq.1.dens.0.txt")->tf   # freq dependent#
read.table("TheorExpSims/All.freq.0.dens.1.txt")->td   # dens dependent #
#
# FD#
#
meansFD<-c()#
stdFD<-c()#
meansFDPrev<-c()#
stdFDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansFD<-c(meansFD,mean(tfd[,i]+tfd[,i+100],na.rm=T))#
	stdFD<-c(stdFD,sd(tfd[,i]+tfd[,i+100],na.rm=T))#
}#
plot(meansFD)#
for (i in seq(101,200)) {#
	meansFDPrev<-c(meansFDPrev,mean(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
	stdFDPrev<-c(stdFDPrev,sd(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
}#
plot(meansFD,meansFDPrev)#
#
# Dens#
#
meansD<-c()#
stdD<-c()#
meansDPrev<-c()#
stdDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansD<-c(meansD,mean(td[,i]+td[,i+100],na.rm=T))#
	stdD<-c(stdD,sd(td[,i]+td[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansDPrev<-c(meansDPrev,mean(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
	stdDPrev<-c(stdDPrev,sd(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
}#
plot(meansD,meansDPrev)#
#
# Freq#
#
meansF<-c()#
stdF<-c()#
meansFPrev<-c()#
stdFPrev<-c()#
for (i in seq(1,100)) {#
	meansF<-c(meansF,mean(tf[,i]+tf[,i+100],na.rm=T))#
	stdF<-c(stdF,sd(tf[,i]+tf[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansFPrev<-c(meansFPrev,mean(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
	stdFPrev<-c(stdFPrev,sd(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
}#
plot(meansF,meansFPrev)#
mydf<-data.frame(pos=c(seq(1,100),seq(1,100),seq(1,100)),abun=c(meansFD,meansD,meansF),prev=c(meansFDPrev,meansDPrev,meansFPrev),maxAbun<-c(meansFD+stdFD,meansD+stdD,meansF+stdF),minAbun<-c(pmax(meansFD-stdFD,0),pmax(meansD-stdD,0),pmax(meansF-stdF,0)),minPrev<-c(pmax(meansFDPrev-stdFDPrev,0),pmax(meansDPrev-stdDPrev,0),pmax(meansFPrev-stdFPrev,0)),maxPrev<-c(meansFDPrev+stdFDPrev,meansDPrev+stdDPrev,meansFPrev+stdFPrev),type=c(rep("both",100),rep("density-dependent",100),rep("frequency-dependent",100)))#
#
plA<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minAbun,ymax=maxAbun,fill=type),alpha=0.3)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Abundance")+geom_line(data=mydf,aes(pos,abun,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
#
plB<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Prevalence")+geom_line(data=mydf,aes(pos,prev,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+ylim(c(0,0.5))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
#
plC<-ggplot()+geom_ribbon(data=mydf,aes(x=abun,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"),name="")+xlab("abundance")+ylab("prevalence")+geom_line(data=mydf,aes(abun,prev,col=type),size=1)+scale_fill_manual(values=wes_palette("Darjeeling1"),name="")+xlim(c(0,7))+ylim(c(0,0.5))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
row1<-plot_grid(plA,plB,plC,ncol=3,labels=c("A","B","C"),rel_widths=c(1,1,1.6))#
#
# Now with real qual#
read.table("TheorExpSims/All.qual.freq.1.dens.1.txt")->tfd      # both freq dependent and dens trans#
read.table("TheorExpSims/All.qual.freq.1.dens.0.txt")->tf   # freq dependent#
read.table("TheorExpSims/All.qual.freq.0.dens.1.txt")->td   # dens dependent #
#
# FD#
#
meansFD<-c()#
stdFD<-c()#
meansFDPrev<-c()#
stdFDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansFD<-c(meansFD,mean(tfd[,i]+tfd[,i+100],na.rm=T))#
	stdFD<-c(stdFD,sd(tfd[,i]+tfd[,i+100],na.rm=T))#
}#
plot(meansFD)#
for (i in seq(101,200)) {#
	meansFDPrev<-c(meansFDPrev,mean(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
	stdFDPrev<-c(stdFDPrev,sd(tfd[,i]/(tfd[,i-100]+tfd[,i]),na.rm=T))#
}#
plot(meansFD,meansFDPrev)#
#
# Dens#
#
meansD<-c()#
stdD<-c()#
meansDPrev<-c()#
stdDPrev<-c()#
#
indThresh<-0#
#
for (i in seq(1,100)) {#
	meansD<-c(meansD,mean(td[,i]+td[,i+100],na.rm=T))#
	stdD<-c(stdD,sd(td[,i]+td[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansDPrev<-c(meansDPrev,mean(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
	stdDPrev<-c(stdDPrev,sd(td[,i]/(td[,i-100]+td[,i]),na.rm=T))#
}#
plot(meansD,meansDPrev)#
#
# Freq#
#
meansF<-c()#
stdF<-c()#
meansFPrev<-c()#
stdFPrev<-c()#
for (i in seq(1,100)) {#
	meansF<-c(meansF,mean(tf[,i]+tf[,i+100],na.rm=T))#
	stdF<-c(stdF,sd(tf[,i]+tf[,i+100],na.rm=T))#
}#
plot(meansD)#
for (i in seq(101,200)) {#
	meansFPrev<-c(meansFPrev,mean(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
	stdFPrev<-c(stdFPrev,sd(tf[,i]/(tf[,i-100]+tf[,i]),na.rm=T))#
}#
plot(meansF,meansFPrev)#
mydf<-data.frame(pos=c(seq(1,100),seq(1,100),seq(1,100)),abun=c(meansFD,meansD,meansF),prev=c(meansFDPrev,meansDPrev,meansFPrev),maxAbun<-c(meansFD+stdFD,meansD+stdD,meansF+stdF),minAbun<-c(pmax(meansFD-stdFD,0),pmax(meansD-stdD,0),pmax(meansF-stdF,0)),minPrev<-c(pmax(meansFDPrev-stdFDPrev,0),pmax(meansDPrev-stdDPrev,0),pmax(meansFPrev-stdFPrev,0)),maxPrev<-c(meansFDPrev+stdFDPrev,meansDPrev+stdDPrev,meansFPrev+stdFPrev),type=c(rep("both",100),rep("density-dependent",100),rep("frequency-dependent",100)))#
#
plD<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minAbun,ymax=maxAbun,fill=type),alpha=0.3)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Abundance")+geom_line(data=mydf,aes(pos,abun,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
#
plE<-ggplot()+geom_ribbon(data=mydf,aes(x=pos,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"))+xlab("position")+ylab("Prevalence")+geom_line(data=mydf,aes(pos,prev,col=type),size=1)+theme(legend.position="none")+scale_fill_manual(values=wes_palette("Darjeeling1"))+ylim(c(0,0.5))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
#
plF<-ggplot()+geom_ribbon(data=mydf,aes(x=abun,ymin=minPrev,ymax=maxPrev,fill=type),alpha=0.5)+scale_color_manual(values=wes_palette("Darjeeling1"),name="")+xlab("abundance")+ylab("prevalence")+geom_line(data=mydf,aes(abun,prev,col=type),size=1)+scale_fill_manual(values=wes_palette("Darjeeling1"),name="")+xlim(c(0,4.5))+ylim(c(0,0.5))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
row2<-plot_grid(plD,plE,plF,ncol=3,labels=c("D","E","F"),rel_widths=c(1,1,1.6))#
#
fin<-plot_grid(row1,row2,ncol=1)#
#
fin
ggsave("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/figures/Fig5.pdf",fin,width=14,height=7)
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
library(viridis)#
#
get_data <-function(betaF,betaVJ,index,thresh) {#
	file = paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsForPlot/sim.betaF.",betaF,".betaVJ.",betaVJ,".txt",sep="")#
	read.table(file)->te#
	#print (te[,index])#
	me = mean(te[,index][te[,10]>thresh])#
	se = sd(te[,index][te[,10]>thresh])/sqrt(length(te[,index][te[,10]>thresh]))#
	return(list(me=me,su = me+se,sd=me-se))#
}#
#
index_list<-c(0.05,0.1,0.2,0.5,1,2,5,10,20)#
thresh<-2#
#
# first, disease persistence#
#
VJonly<-c()#
VJonlySU<-c()#
VJonlySD<-c()#
for (i in index_list) {#
 VJonly<-c(VJonly,get_data(0,i,10,thresh)$me)#
 VJonlySU<-c(VJonlySU,get_data(0,i,10,thresh)$su)#
 VJonlySD<-c(VJonlySD,get_data(0,i,10,thresh)$sd)#
#
}#
#
Fonly<-c()#
FonlySU<-c()#
FonlySD<-c()#
for (i in index_list) {#
 Fonly<-c(Fonly,get_data(i,0,10,thresh)$me)#
 FonlySU<-c(FonlySU,get_data(i,0,10,thresh)$su)#
 FonlySD<-c(FonlySD,get_data(i,0,10,thresh)$sd)#
}#
#
VJfixandF<-c()#
VJfixandFSU<-c()#
VJfixandFSD<-c()#
for (i in index_list) {#
 VJfixandF<-c(VJfixandF,get_data(i,1,10,thresh)$me)#
 VJfixandFSU<-c(VJfixandFSU,get_data(i,1,10,thresh)$su)#
 VJfixandFSD<-c(VJfixandFSD,get_data(i,1,10,thresh)$sd)#
}#
#
FfixandVJ<-c()#
FfixandVJSU<-c()#
FfixandVJSD<-c()#
for (i in index_list) {#
 FfixandVJ<-c(FfixandVJ,get_data(1,i,10,thresh)$me)#
 FfixandVJSU<-c(FfixandVJSU,get_data(1,i,10,thresh)$su)#
 FfixandVJSD<-c(FfixandVJSD,get_data(1,i,10,thresh)$sd)#
}#
df<-data.frame(x=index_list,y=VJonly,yd=VJonlySD,yu=VJonlySU,type=rep("VJ",9))#
df<-rbind(df,data.frame(x=index_list,y=Fonly,yd=FonlySD,yu=FonlySU,type=rep("F",9)))#
df<-rbind(df,data.frame(x=index_list,y=FfixandVJ,yd=FfixandVJSD,yu=FfixandVJSU,type=rep("F_VJ",9)))#
df<-rbind(df,data.frame(x=index_list,y=VJfixandF,yd=VJfixandFSD,yu=VJfixandFSU,type=rep("VJ_F",9)))#
plA<-ggplot(df,aes(x,y,col=type))+geom_point()+geom_line()+scale_x_log10(breaks=c(0.05,0.2,1,5,20))+scale_y_log10(breaks=c(5,10,50,100,500,1000),limits=c(5,1000))+geom_ribbon(aes(ymin=yd,ymax=yu,fill=type,col=type),linetype=0,alpha=0.3)+scale_color_manual(values=wes_palette("Moonrise3"))+scale_fill_manual(values=wes_palette("Moonrise3"))+xlab(expression(beta[rel]))+ylab(expression(italic(T) * " (duration)"))+theme(legend.position="NA")#
# next, extinction#
#
VJonly<-c()#
VJonlySU<-c()#
VJonlySD<-c()#
for (i in index_list) {#
 VJonly<-c(VJonly,get_data(0,i,11,thresh)$me)#
 VJonlySU<-c(VJonlySU,get_data(0,i,11,thresh)$su)#
 VJonlySD<-c(VJonlySD,get_data(0,i,11,thresh)$sd)#
#
}#
#
Fonly<-c()#
FonlySU<-c()#
FonlySD<-c()#
for (i in index_list) {#
 Fonly<-c(Fonly,get_data(i,0,11,thresh)$me)#
 FonlySU<-c(FonlySU,get_data(i,0,11,thresh)$su)#
 FonlySD<-c(FonlySD,get_data(i,0,11,thresh)$sd)#
}#
#
VJfixandF<-c()#
VJfixandFSU<-c()#
VJfixandFSD<-c()#
for (i in index_list) {#
 VJfixandF<-c(VJfixandF,get_data(i,1,11,thresh)$me)#
 VJfixandFSU<-c(VJfixandFSU,get_data(i,1,11,thresh)$su)#
 VJfixandFSD<-c(VJfixandFSD,get_data(i,1,11,thresh)$sd)#
}#
#
FfixandVJ<-c()#
FfixandVJSU<-c()#
FfixandVJSD<-c()#
for (i in index_list) {#
 FfixandVJ<-c(FfixandVJ,get_data(1,i,11,thresh)$me)#
 FfixandVJSU<-c(FfixandVJSU,get_data(1,i,11,thresh)$su)#
 FfixandVJSD<-c(FfixandVJSD,get_data(1,i,11,thresh)$sd)#
}#
#
df<-data.frame(x=index_list,y=VJonly,yd=VJonlySD,yu=VJonlySU,type=rep("VJ",9))#
df<-rbind(df,data.frame(x=index_list,y=Fonly,yd=FonlySD,yu=FonlySU,type=rep("F",9)))#
df<-rbind(df,data.frame(x=index_list,y=FfixandVJ,yd=FfixandVJSD,yu=FfixandVJSU,type=rep("F_VJ",9)))#
df<-rbind(df,data.frame(x=index_list,y=VJfixandF,yd=VJfixandFSD,yu=VJfixandFSU,type=rep("VJ_F",9)))#
plB<-ggplot(df,aes(x,y,col=type))+geom_point()+geom_line()+scale_x_log10(breaks=c(0.05,0.2,1,5,20))+geom_ribbon(aes(ymin=yd,ymax=yu,fill=type,col=type),linetype=0,alpha=0.3)+scale_color_manual(values=wes_palette("Moonrise3"),name="",#
                       labels=c(expression(beta[F] * " = 0, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 0"), expression(beta[F] * " = 1, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 1")))+scale_fill_manual(values=wes_palette("Moonrise3"),name="",#
                       labels=c(expression(beta[F] * " = 0, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 0"), expression(beta[F] * " = 1, " * beta[VJ] * " = " * beta[rel] ), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 1")))+xlab(expression(beta[rel]))+ylab(expression(italic(P) * " (persistence)"))#
# max change in abundance / year in data is (1409-504)/(18-14) = 226.25#
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
library(viridis)#
#
plotAndGetMaxSlope<-function(i) {	#
#
  read.table(paste("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  scan(paste("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  #read.table(paste("/Users/uricchio/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  #scan(paste("/Users/uricchio/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  # if epidemic is shorter than actual, skip#
  if(length(t$V1) < 10 ) {#
  	return (NA)#
  }#
  len=min(length(t$V1),1000)#
  yvals = (t$V1+t$V2)[1:len]#
  popSize<-data.frame(x=seq(1,len),y=yvals)#
#
   M<-nls(y~y0/(1+exp(-r*(x-x0)))+ym, start=list(r=0.2,y0=-(max(yvals)),x0=20,ym=max(yvals)),data=popSize,trace=FALSE,lower=c(0.01,-10000,0.01,0.01),algorithm="port"#
,control = nls.control(minFactor = 1/10000000,maxiter=1000,warnOnly=TRUE))#
  M.df<-data.frame(x=seq(1,len))#
  # y = a / (1 + exp(-b *(x-x0))) + c#
  M.df$y<-coef(M)[2]/(1+exp(-coef(M)[1]*(M.df$x-coef(M)[3])))+coef(M)[4]#
#
  # Deriv is (a b E^(b (x + x0)))/(E^(b x) + E^(b x0))^2 which is maximized at x0, with a value of a*b/4#
  myMax = c(t(t(abs(coef(M)[2]*coef(M)[1]/4))))#
  #if(myMax > 100) {#
    #print(myMax)#
    #print(coef(M)[3])#
    #p<-ggplot(data=popSize,aes(x,y),alpha=0.5)+geom_point()+ylim(c(0,2500))+geom_line(data=M.df,col='red',size=0.7)#
    #p+xlim(1,len)#
    #print(p)#
  #}#
  tot_final = sum(t[len,][1:5],na.rm=T)#
  print(tot_final)#
  if(tot_final > 0) {#
  	tot_final = 1#
  	}#
  return(data.frame(m=myMax,a=as.numeric(params[2]),b=as.numeric(params[3]),l=len,t=tot_final))#
}#
#
data <-data.frame()#
emp<-0#
for ( i in seq(1,20000)) {#
	m<-plotAndGetMaxSlope(i)#
	if(is.na(m)) {#
		emp<-emp+1#
	} else {#
	    data<-rbind(data,m)#
	}#
}#
#
data_plot<-data[data$m<300,]#
#
pl1<-ggplot(data_plot,aes(a,b))+ geom_bin2d(binwidth=c(1,1),aes(fill=cut(m,seq(0,300,15))))+scale_fill_manual(values=wes_palette("Zissou1",21,type="continuous"))#
myPdf<-function(df,at,bt,bw) {#
	if (length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m) == 0) {#
		return(0)#
	}#
	return(length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m)/length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m))#
}#
#
myldf<-function(df,at,bt,bw) {#
	return(mean(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw ,]$t,na.rm=T))#
}#
pdf<-data.frame()#
for (i in seq(0,19,1)) {#
	 for (j in seq(0,19,1)) {#
	     pdf<-rbind(pdf,data.frame(a=i,b=j,f=myPdf(data_plot,i,j,1),t=myldf(data_plot,i,j,1)))    	#
	 } #
}#
#
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='viridis',name=expression(italic(F)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))#
#
pl3<-ggplot(pdf,aes(a,b,color=t))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='magma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))#
plot_grid(pl2,pl3,labels=c("A","B"),rel_widths=c(1,1),ncol=2)
ggsave("~/projects/bootslabOld/anther_smut/manuscript/v2/figures/figSim.pdf",width=7.5*1.3,height=2.8*1.3)
ggsave("~/projects/bootslabOld/anther_smut/manuscript/v2/figures/Fig6.pdf",width=7.5*1.3,height=2.8*1.3)
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='viridis',name=expression(italic(F)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
#
pl3<-ggplot(pdf,aes(a,b,color=t))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='magma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
plot_grid(pl2,pl3,labels=c("A","B"),rel_widths=c(1,1),ncol=2)#
ggsave("~/projects/bootslabOld/anther_smut/manuscript/v2/figures/Fig6.pdf",width=7.5*1.3,height=2.8*1.3)
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
library(viridis)#
#
get_data <-function(betaF,betaVJ,index,thresh) {#
	file = paste("~/projects/bootslabOld/anther_smut/simAnthSmut/simsForPlot/sim.betaF.",betaF,".betaVJ.",betaVJ,".txt",sep="")#
	read.table(file)->te#
	#print (te[,index])#
	me = mean(te[,index][te[,10]>thresh])#
	se = sd(te[,index][te[,10]>thresh])/sqrt(length(te[,index][te[,10]>thresh]))#
	return(list(me=me,su = me+se,sd=me-se))#
}#
#
index_list<-c(0.05,0.1,0.2,0.5,1,2,5,10,20)#
thresh<-2#
#
# first, disease persistence#
#
VJonly<-c()#
VJonlySU<-c()#
VJonlySD<-c()#
for (i in index_list) {#
 VJonly<-c(VJonly,get_data(0,i,10,thresh)$me)#
 VJonlySU<-c(VJonlySU,get_data(0,i,10,thresh)$su)#
 VJonlySD<-c(VJonlySD,get_data(0,i,10,thresh)$sd)#
#
}#
#
Fonly<-c()#
FonlySU<-c()#
FonlySD<-c()#
for (i in index_list) {#
 Fonly<-c(Fonly,get_data(i,0,10,thresh)$me)#
 FonlySU<-c(FonlySU,get_data(i,0,10,thresh)$su)#
 FonlySD<-c(FonlySD,get_data(i,0,10,thresh)$sd)#
}#
#
VJfixandF<-c()#
VJfixandFSU<-c()#
VJfixandFSD<-c()#
for (i in index_list) {#
 VJfixandF<-c(VJfixandF,get_data(i,1,10,thresh)$me)#
 VJfixandFSU<-c(VJfixandFSU,get_data(i,1,10,thresh)$su)#
 VJfixandFSD<-c(VJfixandFSD,get_data(i,1,10,thresh)$sd)#
}#
#
FfixandVJ<-c()#
FfixandVJSU<-c()#
FfixandVJSD<-c()#
for (i in index_list) {#
 FfixandVJ<-c(FfixandVJ,get_data(1,i,10,thresh)$me)#
 FfixandVJSU<-c(FfixandVJSU,get_data(1,i,10,thresh)$su)#
 FfixandVJSD<-c(FfixandVJSD,get_data(1,i,10,thresh)$sd)#
}#
df<-data.frame(x=index_list,y=VJonly,yd=VJonlySD,yu=VJonlySU,type=rep("VJ",9))#
df<-rbind(df,data.frame(x=index_list,y=Fonly,yd=FonlySD,yu=FonlySU,type=rep("F",9)))#
df<-rbind(df,data.frame(x=index_list,y=FfixandVJ,yd=FfixandVJSD,yu=FfixandVJSU,type=rep("F_VJ",9)))#
df<-rbind(df,data.frame(x=index_list,y=VJfixandF,yd=VJfixandFSD,yu=VJfixandFSU,type=rep("VJ_F",9)))#
plA<-ggplot(df,aes(x,y,col=type))+geom_point()+geom_line()+scale_x_log10(breaks=c(0.05,0.2,1,5,20))+scale_y_log10(breaks=c(5,10,50,100,500,1000),limits=c(5,1000))+geom_ribbon(aes(ymin=yd,ymax=yu,fill=type,col=type),linetype=0,alpha=0.3)+scale_color_manual(values=wes_palette("Moonrise3"))+scale_fill_manual(values=wes_palette("Moonrise3"))+xlab(expression(beta[rel]))+ylab(expression(italic(T) * " (duration)"))+theme(legend.position="NA")#
# next, extinction#
#
VJonly<-c()#
VJonlySU<-c()#
VJonlySD<-c()#
for (i in index_list) {#
 VJonly<-c(VJonly,get_data(0,i,11,thresh)$me)#
 VJonlySU<-c(VJonlySU,get_data(0,i,11,thresh)$su)#
 VJonlySD<-c(VJonlySD,get_data(0,i,11,thresh)$sd)#
#
}#
#
Fonly<-c()#
FonlySU<-c()#
FonlySD<-c()#
for (i in index_list) {#
 Fonly<-c(Fonly,get_data(i,0,11,thresh)$me)#
 FonlySU<-c(FonlySU,get_data(i,0,11,thresh)$su)#
 FonlySD<-c(FonlySD,get_data(i,0,11,thresh)$sd)#
}#
#
VJfixandF<-c()#
VJfixandFSU<-c()#
VJfixandFSD<-c()#
for (i in index_list) {#
 VJfixandF<-c(VJfixandF,get_data(i,1,11,thresh)$me)#
 VJfixandFSU<-c(VJfixandFSU,get_data(i,1,11,thresh)$su)#
 VJfixandFSD<-c(VJfixandFSD,get_data(i,1,11,thresh)$sd)#
}#
#
FfixandVJ<-c()#
FfixandVJSU<-c()#
FfixandVJSD<-c()#
for (i in index_list) {#
 FfixandVJ<-c(FfixandVJ,get_data(1,i,11,thresh)$me)#
 FfixandVJSU<-c(FfixandVJSU,get_data(1,i,11,thresh)$su)#
 FfixandVJSD<-c(FfixandVJSD,get_data(1,i,11,thresh)$sd)#
}#
#
df<-data.frame(x=index_list,y=VJonly,yd=VJonlySD,yu=VJonlySU,type=rep("VJ",9))#
df<-rbind(df,data.frame(x=index_list,y=Fonly,yd=FonlySD,yu=FonlySU,type=rep("F",9)))#
df<-rbind(df,data.frame(x=index_list,y=FfixandVJ,yd=FfixandVJSD,yu=FfixandVJSU,type=rep("F_VJ",9)))#
df<-rbind(df,data.frame(x=index_list,y=VJfixandF,yd=VJfixandFSD,yu=VJfixandFSU,type=rep("VJ_F",9)))#
plB<-ggplot(df,aes(x,y,col=type))+geom_point()+geom_line()+scale_x_log10(breaks=c(0.05,0.2,1,5,20))+geom_ribbon(aes(ymin=yd,ymax=yu,fill=type,col=type),linetype=0,alpha=0.3)+scale_color_manual(values=wes_palette("Moonrise3"),name="",#
                       labels=c(expression(beta[F] * " = 0, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 0"), expression(beta[F] * " = 1, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 1")))+scale_fill_manual(values=wes_palette("Moonrise3"),name="",#
                       labels=c(expression(beta[F] * " = 0, " * beta[VJ] * " = " * beta[rel]), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 0"), expression(beta[F] * " = 1, " * beta[VJ] * " = " * beta[rel] ), expression(beta[F] * " = " * beta[rel] * ", " * beta[VJ] * " = 1")))+xlab(expression(beta[rel]))+ylab(expression(italic(P) * " (persistence)"))#
# max change in abundance / year in data is (1409-504)/(18-14) = 226.25#
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
library(viridis)#
#
plotAndGetMaxSlope<-function(i) {	#
#
  read.table(paste("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  scan(paste("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  #read.table(paste("/Users/uricchio/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  #scan(paste("/Users/uricchio/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  # if epidemic is shorter than actual, skip#
  if(length(t$V1) < 10 ) {#
  	return (NA)#
  }#
  len=min(length(t$V1),1000)#
  yvals = (t$V1+t$V2)[1:len]#
  popSize<-data.frame(x=seq(1,len),y=yvals)#
#
   M<-nls(y~y0/(1+exp(-r*(x-x0)))+ym, start=list(r=0.2,y0=-(max(yvals)),x0=20,ym=max(yvals)),data=popSize,trace=FALSE,lower=c(0.01,-10000,0.01,0.01),algorithm="port"#
,control = nls.control(minFactor = 1/10000000,maxiter=1000,warnOnly=TRUE))#
  M.df<-data.frame(x=seq(1,len))#
  # y = a / (1 + exp(-b *(x-x0))) + c#
  M.df$y<-coef(M)[2]/(1+exp(-coef(M)[1]*(M.df$x-coef(M)[3])))+coef(M)[4]#
#
  # Deriv is (a b E^(b (x + x0)))/(E^(b x) + E^(b x0))^2 which is maximized at x0, with a value of a*b/4#
  myMax = c(t(t(abs(coef(M)[2]*coef(M)[1]/4))))#
  #if(myMax > 100) {#
    #print(myMax)#
    #print(coef(M)[3])#
    #p<-ggplot(data=popSize,aes(x,y),alpha=0.5)+geom_point()+ylim(c(0,2500))+geom_line(data=M.df,col='red',size=0.7)#
    #p+xlim(1,len)#
    #print(p)#
  #}#
  tot_final = sum(t[len,][1:5],na.rm=T)#
  print(tot_final)#
  if(tot_final > 0) {#
  	tot_final = 1#
  	}#
  return(data.frame(m=myMax,a=as.numeric(params[2]),b=as.numeric(params[3]),l=len,t=tot_final))#
}#
#
data <-data.frame()#
emp<-0#
for ( i in seq(1,20000)) {#
	m<-plotAndGetMaxSlope(i)#
	if(is.na(m)) {#
		emp<-emp+1#
	} else {#
	    data<-rbind(data,m)#
	}#
}#
#
data_plot<-data[data$m<300,]#
#
pl1<-ggplot(data_plot,aes(a,b))+ geom_bin2d(binwidth=c(1,1),aes(fill=cut(m,seq(0,300,15))))+scale_fill_manual(values=wes_palette("Zissou1",21,type="continuous"))#
myPdf<-function(df,at,bt,bw) {#
	if (length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m) == 0) {#
		return(0)#
	}#
	return(length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m)/length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m))#
}#
#
myldf<-function(df,at,bt,bw) {#
	return(mean(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw ,]$t,na.rm=T))#
}#
pdf<-data.frame()#
for (i in seq(0,19,1)) {#
	 for (j in seq(0,19,1)) {#
	     pdf<-rbind(pdf,data.frame(a=i,b=j,f=myPdf(data_plot,i,j,1),t=myldf(data_plot,i,j,1)))    	#
	 } #
}#
#
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='viridis',name=expression(italic(F)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
#
pl3<-ggplot(pdf,aes(a,b,color=t))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='magma',name=expression(italic(P)))+xlab(expression(frac(beta[VJ],beta[VJ[0]])))+ylab(expression(frac(beta[F],beta[F[0]])))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
plot_grid(pl2,pl3,labels=c("A","B"),rel_widths=c(1,1),ncol=2)#
ggsave("~/projects/bootslabOld/anther_smut/manuscript/v2/figures/Fig6.pdf",width=7.5*1.3,height=2.8*1.3)
# max change in abundance / year in data is (1409-504)/(18-14) = 226.25#
library(ggplot2)#
library(cowplot)#
library(wesanderson)#
library(viridis)#
#
plotAndGetMaxSlope<-function(i) {	#
#
  read.table(paste("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  scan(paste("/Users/uricchio/projects/bootslabOld/anther_smut/manuscript/v2/software/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  #read.table(paste("/Users/uricchio/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""))->t#
  #scan(paste("/Users/uricchio/projects/bootslabOld/anther_smut/simAnthSmut/simsRepGenRandHigh/sim.",i,".txt",sep=""),nlines=1,what=c("a"))->params#
  # if epidemic is shorter than actual, skip#
  if(length(t$V1) < 10 ) {#
  	return (NA)#
  }#
  len=min(length(t$V1),1000)#
  yvals = (t$V1+t$V2)[1:len]#
  popSize<-data.frame(x=seq(1,len),y=yvals)#
#
   M<-nls(y~y0/(1+exp(-r*(x-x0)))+ym, start=list(r=0.2,y0=-(max(yvals)),x0=20,ym=max(yvals)),data=popSize,trace=FALSE,lower=c(0.01,-10000,0.01,0.01),algorithm="port"#
,control = nls.control(minFactor = 1/10000000,maxiter=1000,warnOnly=TRUE))#
  M.df<-data.frame(x=seq(1,len))#
  # y = a / (1 + exp(-b *(x-x0))) + c#
  M.df$y<-coef(M)[2]/(1+exp(-coef(M)[1]*(M.df$x-coef(M)[3])))+coef(M)[4]#
#
  # Deriv is (a b E^(b (x + x0)))/(E^(b x) + E^(b x0))^2 which is maximized at x0, with a value of a*b/4#
  myMax = c(t(t(abs(coef(M)[2]*coef(M)[1]/4))))#
  #if(myMax > 100) {#
    #print(myMax)#
    #print(coef(M)[3])#
    #p<-ggplot(data=popSize,aes(x,y),alpha=0.5)+geom_point()+ylim(c(0,2500))+geom_line(data=M.df,col='red',size=0.7)#
    #p+xlim(1,len)#
    #print(p)#
  #}#
  tot_final = sum(t[len,][1:5],na.rm=T)#
  print(tot_final)#
  if(tot_final > 0) {#
  	tot_final = 1#
  	}#
  return(data.frame(m=myMax,a=as.numeric(params[2]),b=as.numeric(params[3]),l=len,t=tot_final))#
}#
#
data <-data.frame()#
emp<-0#
for ( i in seq(1,20000)) {#
	m<-plotAndGetMaxSlope(i)#
	if(is.na(m)) {#
		emp<-emp+1#
	} else {#
	    data<-rbind(data,m)#
	}#
}#
#
data_plot<-data[data$m<300,]#
#
pl1<-ggplot(data_plot,aes(a,b))+ geom_bin2d(binwidth=c(1,1),aes(fill=cut(m,seq(0,300,15))))+scale_fill_manual(values=wes_palette("Zissou1",21,type="continuous"))#
myPdf<-function(df,at,bt,bw) {#
	if (length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m) == 0) {#
		return(0)#
	}#
	return(length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw & df$m >226.25,]$m)/length(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw,]$m))#
}#
#
myldf<-function(df,at,bt,bw) {#
	return(mean(df[df$a>at & df$b>bt & df$a<at+bw & df$b<bt+bw ,]$t,na.rm=T))#
}#
pdf<-data.frame()#
for (i in seq(0,19,1)) {#
	 for (j in seq(0,19,1)) {#
	     pdf<-rbind(pdf,data.frame(a=i,b=j,f=myPdf(data_plot,i,j,1),t=myldf(data_plot,i,j,1)))    	#
	 } #
}#
#
pl2<-ggplot(pdf,aes(a,b,color=f))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='viridis',name=expression(italic(F)))+xlab(expression(frac(beta[d],beta[d[0]])))+ylab(expression(frac(beta[f],beta[f[0]])))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
#
pl3<-ggplot(pdf,aes(a,b,color=t))+ geom_point(shape=15,size=5)+scale_colour_viridis(option='magma',name=expression(italic(P)))+xlab(expression(frac(beta[d],beta[d[0]])))+ylab(expression(frac(beta[f],beta[f[0]])))+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),#
panel.background = element_blank(), axis.line = element_line(colour = "black"))#
plot_grid(pl2,pl3,labels=c("A","B"),rel_widths=c(1,1),ncol=2)#
ggsave("~/projects/bootslabOld/anther_smut/manuscript/v2/figures/Fig6.pdf",width=7.5*1.3,height=2.8*1.3)
